<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ショート学習アプリ（完成版）</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script type="module" src="script.js"></script>
</head>

<body>
    <div class="app-container">
        <div id="initial-loader">
            <div class="loader"></div>
            <p style="margin-top:14px;color:var(--ai-accent-color);font-weight:700">アプリを起動中...</p>
        </div>

        <div id="search-home-panel" class="hidden">
            <div class="search-box">
                <input id="search-input" placeholder="何を学びますか？" />
                <button id="search-button">検索</button>
            </div>
            <h2 class="history-title">検索履歴</h2>
            <ul id="history-list" class="history-list"></ul>
        </div>

        <div id="main-content" class="hidden">
            <header class="header">
                <div class="top-bar">
                    <svg id="home-icon" class="action-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" />
                    </svg>
                    <div id="topic-title" class="topic-title"></div>
                    <div id="fetching-indicator">
                        <div class="loader small"></div>
                        <span id="fetching-text"></span>
                    </div>
                </div>
                <nav class="tabs">
                    <div class="tab-item active" data-tab="feed">学習</div>
                    <div class="tab-item" data-tab="likes">プレイリスト</div>
                </nav>
                <div id="message-banner" class="message-banner hidden"></div>
            </header>

            <main class="content-area">
                <section id="feed-panel" class="content-panel active">
                    <div id="card-container" class="card-container"></div>
                </section>
                <section id="likes-panel" class="content-panel">
                    <div id="playlist-list-view"></div>
                    <div id="playlist-cards-view" class="hidden"></div>
                </section>
            </main>
        </div>
    </div>

    <!-- AI modal -->
    <div id="ai-modal" class="modal-backdrop">
        <div class="modal-content">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                <h3 style="margin:0">✨ AIによるコード解説</h3>
                <button id="ai-modal-close"
                    style="background:none;border:none;color:var(--text-color);font-size:20px;cursor:pointer">&times;</button>
            </div>
            <div id="ai-modal-body" style="line-height:1.6"></div>
        </div>
    </div>

    <!-- Playlist modal -->
    <div id="playlist-modal" class="modal-backdrop">
        <div class="modal-content">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                <h3 style="margin:0">プレイリストに追加</h3>
                <button id="playlist-modal-close"
                    style="background:none;border:none;color:var(--text-color);font-size:20px;cursor:pointer">&times;</button>
            </div>
            <div id="playlist-modal-list"></div>
            <div style="margin-top:12px;border-top:1px solid var(--border-color);padding-top:10px;display:flex;gap:8px">
                <input id="new-playlist-input" placeholder="新規プレイリスト名"
                    style="flex:1;padding:8px;border-radius:8px;border:1px solid var(--border-color);background:var(--primary-bg);color:var(--text-color)" />
                <button id="create-playlist-btn"
                    style="background:var(--ai-accent-color);border:none;padding:8px 12px;border-radius:8px;color:#fff">
                    作成
                </button>
            </div>
        </div>
    </div>

    <!-- Debug UI (完成版は非表示のまま) -->
    <div id="debug-panel"><strong>Debug / Raw API</strong>
        <pre id="debug-pre"></pre>
    </div>
    <button id="debug-toggle">DEBUG</button>
</body>

</html>
